<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>한글입숨 | 영화, 드라마 명대사 입숨 | MouthBreath</title>

    <link rel="stylesheet" href="./lib/bootstrap-4.3.1-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="./style.css">
</head>
<body>
<div class="container">
    <h1 class="font-weight-bolder text-center main-title">한국 영화 명대사 입숨</h1>
    <div class="row main-wrap">
        <div class="col-sm-6 movie-select">
            <div class="row">
                <div class="col-sm-6">
                    <div class="card poster" data-movie_name="the_war_of_flower">
                        <img class="card-img-top" src="./assets/images/posters/the_war_of_flower.jpg" alt="Card image">
                        <div class="card-body">
                            <h4 class="card-title text-center font-weight-bolder">타짜<small> (2006)</small></h4>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card poster" data-movie_name="sunflower">
                        <img class="card-img-top" src="./assets/images/posters/sunflower.png" alt="Card image">
                        <div class="card-body">
                            <h4 class="card-title text-center font-weight-bolder">해바라기<small> (2006)</small></h4>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="card poster" data-movie_name="nameless_ganster">
                        <img class="card-img-top" src="./assets/images/posters/nameless_ganster.jpg" alt="Card image">
                        <div class="card-body">
                            <h4 class="card-title text-center font-weight-bolder">범죄와의 전쟁<small> (2011)</small></h4>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="card poster" data-movie_name="man_from_nowhere">
                        <img class="card-img-top" src="./assets/images/posters/man_from_nowhere.jpg" alt="Card image">
                        <div class="card-body">
                            <h4 class="card-title text-center font-weight-bolder">아저씨<small> (2010)</small></h4>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="card poster" data-movie_name="spirit_of_jeet_keun_do">
                        <img class="card-img-top" src="./assets/images/posters/spirit_of_jeet_keun_do.jpg" alt="Card image">
                        <div class="card-body">
                            <h4 class="card-title text-center font-weight-bolder">말죽거리 잔혹사<small> (2004)</small></h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-6 script">
            <h5>현재 선택 영화 : <p id="current_selected_movie" style="display: inline-block;">타짜</p></h5>
            <div class="row" id="script-selector">
                <button type="button" class="btn btn-dark script-select-button col-sm-5" id="random">Random</button>
            </div>
            <hr class="separator">
            <div class="row">
                <div class="col-sm-10" id="title-display" style="font-weight: bolder; font-size: 20px;">
                    -
                </div>
                <div class="col-sm-2">
                    <button class="btn btn-secondary" id="copy">복사</button>
                </div>
                <div class="col-sm-12" id="script-display">

                </div>
            </div>
        </div>
    </div>
</div>
<!--EndOfContainer-->

<!--ScriptSection-->
<script src="./lib/jquery-3.3.1/jquery-3.3.1.slim.min.js" type="text/javascript"></script>
<script src="./lib/popper/popper.min.js" type="text/javascript"></script>
<script src="./lib/bootstrap-4.3.1-dist/js/bootstrap.min.js" type="text/javascript"></script>
<script src="./assets/js/dialogue.js"></script>
<script type="text/javascript">
    let currentSelectedMovie = 'the_war_of_flower';
    let movieNames = {
        'the_war_of_flower': '타짜',
        'sunflower': '해바라기',
        'nameless_ganster': '범죄와의 전쟁',
        'man_from_nowhere': '아저씨',
        'spirit_of_jeet_keun_do': '말죽거리 잔혹사'
    };

    $('.poster').click(function (e) {
        let movieName = $(this).data('movie_name');
        currentSelectedMovie = movieName;
        $('#current_selected_movie').text(movieNames[currentSelectedMovie]);
        let buttons = '<button type="button" class="btn btn-dark script-select-button col-sm-5" onclick="scriptRandom()">Random</button>';

        dialogue[movieName].forEach(function (item, index) {
            buttons +='<button type="button" class="btn btn-dark script-select-button col-sm-5" onclick="scriptSelect(' + index + ')">' + item[0] + '<small> ('+ item[1].length +')</small></button>';
        });
        $('#script-selector').html(buttons);
    });

    $(document).ready(function (e) {
        $('[data-movie_name="the_war_of_flower"]').click();
    });

    function scriptSelect(index){
        $('#title-display').text(dialogue[currentSelectedMovie][index][0]);
        $('#script-display').text(dialogue[currentSelectedMovie][index][1]);
    }

    function scriptRandom() {
        let dialogueCount = dialogue[currentSelectedMovie].length;
        let randomSelectedIndex = Math.floor(Math.random() * dialogueCount);
        $('#title-display').text(dialogue[currentSelectedMovie][randomSelectedIndex][0]);
        $('#script-display').text(dialogue[currentSelectedMovie][randomSelectedIndex][1]);
    }

    function copyToClipboard(val) {
        var t = document.createElement("textarea");
        document.body.appendChild(t);
        t.value = val;
        t.select();
        document.execCommand('copy');
        document.body.removeChild(t);
    }

    $('#copy').click(function (e) {
        let currentSelectedDialogue = $('#script-display').text();
        copyToClipboard(currentSelectedDialogue);
        alert('복사됨!');
    });

    function copyToClipboard(val) {
        var t = document.createElement("textarea");
        document.body.appendChild(t);
        t.value = val;
        t.select();
        document.execCommand('copy');
        document.body.removeChild(t);
    }

</script>
</body>
</html>